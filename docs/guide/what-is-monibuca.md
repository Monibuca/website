# 什么是Monibuca

Monibuca（简称 m7s）是一款纯 Go 语言开发的开源流媒体服务器开发框架，具有高度可扩展性和易部署特性，专为构建高性能、低延迟的流媒体应用而设计，同时提供友好的二次开发接口，方便开发者快速定制自己的流媒体解决方案。

## Monibuca 的核心特性

Monibuca 具有以下核心特性，使其成为流媒体服务领域的强大工具：

### 卓越性能

- **高性能架构** - 采用无锁设计、部分手动内存管理和多核计算技术，实现极高的处理效率
- **低延迟传输** - 零等待转发机制，保证全链路亚秒级延迟，适合实时交互场景
- **资源高效利用** - 优化的内存和 CPU 使用，支持高并发负载

### 灵活扩展

- **插件化架构** - 核心功能通过插件实现，按需加载，无限扩展能力
- **自定义能力** - 支持开发自定义插件，实现特定业务需求
- **多协议支持** - 内置支持 RTMP、RTSP、HTTP-FLV、WS-FLV、HLS、WebRTC、GB28181、ONVIF、SRT 等主流流媒体协议

### 丰富功能

- **媒体处理** - 支持截图、转码、SEI 数据处理
- **集群能力** - 内置级联和房间管理功能，支持分布式部署
- **预览功能** - 支持视频预览、分屏预览、自定义分屏
- **安全保障** - 提供加密传输和流鉴权能力
- **录制回放** - 支持 MP4、HLS、FLV 格式录制，具备倍速播放、拖拽快进、暂停等交互能力
- **动态时移** - 动态缓存设计，支持直播时移回看
- **远程调用** - 支持 gRPC 接口，方便跨语言集成
- **流别名** - 支持动态设置流别名，灵活管理多路流，实现导播功能
- **AI 集成** - 集成推理引擎，支持 ONNX 模型，可自定义前置处理，后置处理，以及画框

### 开发友好

- **调试支持** - 内置调试插件，支持实时性能监控和分析
- **监控系统** - 支持 Prometheus 监控，提供全面的性能指标
- **日志管理** - 日志轮转、自动清理、自定义扩展
- **WebHook** - 支持订阅流的生命周期事件，实现业务系统联动
- **完整示例** - 丰富的示例代码，帮助快速上手

## Monibuca 架构设计

Monibuca 采用模块化、插件化的架构设计，主要由以下核心部分组成：

### 核心框架

- **流媒体引擎** - 处理音视频数据转发的核心组件
- **插件系统** - 提供完整的插件生命周期管理
- **任务系统** - 管理异步任务，优化性能
- **配置管理** - 统一的配置加载和管理机制
- **日志系统** - 可定制的日志记录和处理
- **API服务** - 提供 HTTP、gRPC 接口

### 核心转发流程

Monibuca 的核心转发流程主要包括以下几个关键环节：

#### 发布者（Publisher）

发布者是向服务器的 RingBuffer 中写入音视频数据的对象，负责：
- 通过 WriteVideo 和 WriteAudio 方法写入数据
- 创建 Track，解析数据，生成 ICodecCtx
- 支持多种数据来源：
  - 接受推流（RTMP、RTSP 等协议）
  - 从远端拉流（RTMP、RTSP、HTTP-FLV 等）
  - 从本地录像文件中拉流

#### 订阅者（Subscriber）

订阅者是从 RingBuffer 中读取音视频数据的对象，主要功能包括：
- 订阅特定流，读取数据并处理
- 支持多种数据输出：
  - 接受拉流请求（RTMP、RTSP、HTTP-FLV、HLS 等）
  - 向远端推流
  - 写入本地文件（录制功能）

#### 按需拉流机制

Monibuca 支持智能的按需拉流机制：
- 由订阅者触发，当没有发布者时自动拉流
- 通过正则表达式配置，防止重复拉流
- 支持级联、按需录制回放等高级场景

### 插件生命周期

Monibuca 的插件具有完整的生命周期管理：

1. **注册阶段** - 插件通过 `InstallPlugin` 函数注册
2. **初始化阶段** - 加载配置、准备资源
3. **启动阶段** - 启动服务、网络监听
4. **停止阶段** - 停止服务、清理资源
5. **销毁阶段** - 完全释放资源，防止内存泄漏

### 流处理机制

Monibuca 采用高效的流处理机制：

- **发布者-订阅者模式** - 支持一对多分发
- **转发机制** - 高效的数据转发，减少中间环节
- **别名机制** - 灵活映射不同流，支持动态切换
- **鉴权机制** - 可定制的流发布和订阅鉴权

## 使用场景

Monibuca 适用于多种流媒体应用场景：

### 1. 直播平台

- **功能支持**：推流、拉流、转码、录制、截图、延时播放
- **特性优势**：高并发、低延迟、多协议支持
- **使用案例**：视频直播平台、游戏直播、活动直播

### 2. 视频会议

- **功能支持**：WebRTC、多方通话、录制回放
- **特性优势**：端到端低延迟、高质量传输、安全加密
- **使用案例**：远程会议、在线培训、远程协作

### 3. 安防监控

- **功能支持**：GB28181、ONVIF、NVR集成、云存储、智能分析
- **特性优势**：7x24小时稳定运行、多设备接入、动态扩展
- **使用案例**：平安城市、智慧园区、监控中心

### 4. 在线教育

- **功能支持**：课程直播、录制回放、互动功能
- **特性优势**：稳定可靠、低延迟互动、录制回看
- **使用案例**：在线课堂、远程教育、培训系统

### 5. AI视觉分析

- **功能支持**：视频流AI分析、ONNX模型集成、实时处理
- **特性优势**：流处理+AI集成、低延迟分析、多流并行
- **使用案例**：智能交通、行为识别、工业质检

## 社区支持

- **微信公众号**：不卡科技
- **QQ群**：751639168
- **QQ频道**：p0qq0crz08
- **官方网站**：[https://monibuca.com](https://monibuca.com)

## 许可证

Monibuca 采用 AGPL 许可证。如需商业使用，请联系开发团队获取商业许可。 